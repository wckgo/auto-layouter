var al=function(t){"use strict";function r(t){return t&&Number.isFinite(t.x)&&Number.isFinite(t.y)}function e(t,e){return r(t)&&r(e)}function n(t){return t&&Number.isFinite(t.x)&&Number.isFinite(t.y)&&Number.isFinite(t.width)&&Number.isFinite(t.height)}function o(t,r){return{x:t.x+r.x,y:t.y+r.y}}function i(t,r){return{x:t.x*r,y:t.y*r}}function u(t,r){return t.x*r.x+t.y*r.y}function c(t){return{x:t[0],y:t[1]}}const a={UP:[0,-1],RIGHT:[1,0],DOWN:[0,1],LEFT:[-1,0],MID:[0,0]},s=Object.keys(a).reduce((t,r)=>(t[r]=r.toLowerCase(),t),{});function f(t){return a[t.toUpperCase()]}function l(t){return"string"==typeof t&&s.hasOwnProperty(t.toUpperCase())}function h(t,r){return t.find(t=>t!==r)}function p(t,r){let e;const n=t.find(t=>(function(t,r){return t.x*r.y-t.y*r.x==0})(t,r));return e=u(n,r)>0?n:h(t,n)}var v="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,d=v||y||Function("return this")(),b=d.Symbol,_=Object.prototype,g=_.hasOwnProperty,j=_.toString,w=b?b.toStringTag:void 0;var x=Object.prototype.toString;var m="[object Null]",O="[object Undefined]",A=b?b.toStringTag:void 0;function M(t){return null==t?void 0===t?O:m:A&&A in Object(t)?function(t){var r=g.call(t,w),e=t[w];try{t[w]=void 0;var n=!0}catch(t){}var o=j.call(t);return n&&(r?t[w]=e:delete t[w]),o}(t):function(t){return x.call(t)}(t)}function S(t){return null!=t&&"object"==typeof t}var P="[object Symbol]";function z(t){return"symbol"==typeof t||S(t)&&M(t)==P}var E=Array.isArray,T=1/0,F=b?b.prototype:void 0,C=F?F.toString:void 0;function k(t){if("string"==typeof t)return t;if(E(t))return function(t,r){for(var e=-1,n=null==t?0:t.length,o=Array(n);++e<n;)o[e]=r(t[e],e,t);return o}(t,k)+"";if(z(t))return C?C.call(t):"";var r=t+"";return"0"==r&&1/t==-T?"-0":r}function D(t){var r=typeof t;return null!=t&&("object"==r||"function"==r)}function L(t){return t}var N="[object AsyncFunction]",G="[object Function]",I="[object GeneratorFunction]",X="[object Proxy]";function Y(t){if(!D(t))return!1;var r=M(t);return r==G||r==I||r==N||r==X}var U,$=d["__core-js_shared__"],B=(U=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"";var q=Function.prototype.toString;function R(t){if(null!=t){try{return q.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var W=/^\[object .+?Constructor\]$/,V=Function.prototype,H=Object.prototype,J=V.toString,K=H.hasOwnProperty,Q=RegExp("^"+J.call(K).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Z(t){return!(!D(t)||(r=t,B&&B in r))&&(Y(t)?Q:W).test(R(t));var r}function tt(t,r){var e=function(t,r){return null==t?void 0:t[r]}(t,r);return Z(e)?e:void 0}var rt=tt(d,"WeakMap"),et=Object.create,nt=function(){function t(){}return function(r){if(!D(r))return{};if(et)return et(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();function ot(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}var it=800,ut=16,ct=Date.now;var at,st,ft,lt=function(){try{var t=tt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),ht=(at=lt?function(t,r){return lt(t,"toString",{configurable:!0,enumerable:!1,value:(e=r,function(){return e}),writable:!0});var e}:L,st=0,ft=0,function(){var t=ct(),r=ut-(t-ft);if(ft=t,r>0){if(++st>=it)return arguments[0]}else st=0;return at.apply(void 0,arguments)}),pt=9007199254740991,vt=/^(?:0|[1-9]\d*)$/;function yt(t,r){var e=typeof t;return!!(r=null==r?pt:r)&&("number"==e||"symbol"!=e&&vt.test(t))&&t>-1&&t%1==0&&t<r}function dt(t,r,e){"__proto__"==r&&lt?lt(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function bt(t,r){return t===r||t!=t&&r!=r}var _t=Object.prototype.hasOwnProperty;function gt(t,r,e){var n=t[r];_t.call(t,r)&&bt(n,e)&&(void 0!==e||r in t)||dt(t,r,e)}var jt=Math.max;function wt(t,r){return ht(function(t,r,e){return r=jt(void 0===r?t.length-1:r,0),function(){for(var n=arguments,o=-1,i=jt(n.length-r,0),u=Array(i);++o<i;)u[o]=n[r+o];o=-1;for(var c=Array(r+1);++o<r;)c[o]=n[o];return c[r]=e(u),ot(t,this,c)}}(t,r,L),t+"")}var xt=9007199254740991;function mt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=xt}function Ot(t){return null!=t&&mt(t.length)&&!Y(t)}var At=Object.prototype;function Mt(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||At)}var St="[object Arguments]";function Pt(t){return S(t)&&M(t)==St}var zt=Object.prototype,Et=zt.hasOwnProperty,Tt=zt.propertyIsEnumerable,Ft=Pt(function(){return arguments}())?Pt:function(t){return S(t)&&Et.call(t,"callee")&&!Tt.call(t,"callee")};var Ct="object"==typeof t&&t&&!t.nodeType&&t,kt=Ct&&"object"==typeof module&&module&&!module.nodeType&&module,Dt=kt&&kt.exports===Ct?d.Buffer:void 0,Lt=(Dt?Dt.isBuffer:void 0)||function(){return!1},Nt={};Nt["[object Float32Array]"]=Nt["[object Float64Array]"]=Nt["[object Int8Array]"]=Nt["[object Int16Array]"]=Nt["[object Int32Array]"]=Nt["[object Uint8Array]"]=Nt["[object Uint8ClampedArray]"]=Nt["[object Uint16Array]"]=Nt["[object Uint32Array]"]=!0,Nt["[object Arguments]"]=Nt["[object Array]"]=Nt["[object ArrayBuffer]"]=Nt["[object Boolean]"]=Nt["[object DataView]"]=Nt["[object Date]"]=Nt["[object Error]"]=Nt["[object Function]"]=Nt["[object Map]"]=Nt["[object Number]"]=Nt["[object Object]"]=Nt["[object RegExp]"]=Nt["[object Set]"]=Nt["[object String]"]=Nt["[object WeakMap]"]=!1;var Gt="object"==typeof t&&t&&!t.nodeType&&t,It=Gt&&"object"==typeof module&&module&&!module.nodeType&&module,Xt=It&&It.exports===Gt&&v.process,Yt=function(){try{var t=It&&It.require&&It.require("util").types;return t||Xt&&Xt.binding&&Xt.binding("util")}catch(t){}}(),Ut=Yt&&Yt.isTypedArray,$t=Ut?function(t){return function(r){return t(r)}}(Ut):function(t){return S(t)&&mt(t.length)&&!!Nt[M(t)]},Bt=Object.prototype.hasOwnProperty;function qt(t,r){var e=E(t),n=!e&&Ft(t),o=!e&&!n&&Lt(t),i=!e&&!n&&!o&&$t(t),u=e||n||o||i,c=u?function(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}(t.length,String):[],a=c.length;for(var s in t)!r&&!Bt.call(t,s)||u&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||yt(s,a))||c.push(s);return c}function Rt(t,r){return function(e){return t(r(e))}}var Wt=Rt(Object.keys,Object),Vt=Object.prototype.hasOwnProperty;function Ht(t){return Ot(t)?qt(t):function(t){if(!Mt(t))return Wt(t);var r=[];for(var e in Object(t))Vt.call(t,e)&&"constructor"!=e&&r.push(e);return r}(t)}var Jt=Object.prototype.hasOwnProperty;function Kt(t){if(!D(t))return function(t){var r=[];if(null!=t)for(var e in Object(t))r.push(e);return r}(t);var r=Mt(t),e=[];for(var n in t)("constructor"!=n||!r&&Jt.call(t,n))&&e.push(n);return e}function Qt(t){return Ot(t)?qt(t,!0):Kt(t)}var Zt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tr=/^\w*$/;function rr(t,r){if(E(t))return!1;var e=typeof t;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=t&&!z(t))||(tr.test(t)||!Zt.test(t)||null!=r&&t in Object(r))}var er=tt(Object,"create");var nr="__lodash_hash_undefined__",or=Object.prototype.hasOwnProperty;var ir=Object.prototype.hasOwnProperty;var ur="__lodash_hash_undefined__";function cr(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}function ar(t,r){for(var e=t.length;e--;)if(bt(t[e][0],r))return e;return-1}cr.prototype.clear=function(){this.__data__=er?er(null):{},this.size=0},cr.prototype.delete=function(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r},cr.prototype.get=function(t){var r=this.__data__;if(er){var e=r[t];return e===nr?void 0:e}return or.call(r,t)?r[t]:void 0},cr.prototype.has=function(t){var r=this.__data__;return er?void 0!==r[t]:ir.call(r,t)},cr.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=er&&void 0===r?ur:r,this};var sr=Array.prototype.splice;function fr(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}fr.prototype.clear=function(){this.__data__=[],this.size=0},fr.prototype.delete=function(t){var r=this.__data__,e=ar(r,t);return!(e<0)&&(e==r.length-1?r.pop():sr.call(r,e,1),--this.size,!0)},fr.prototype.get=function(t){var r=this.__data__,e=ar(r,t);return e<0?void 0:r[e][1]},fr.prototype.has=function(t){return ar(this.__data__,t)>-1},fr.prototype.set=function(t,r){var e=this.__data__,n=ar(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this};var lr=tt(d,"Map");function hr(t,r){var e,n,o=t.__data__;return("string"==(n=typeof(e=r))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof r?"string":"hash"]:o.map}function pr(t){var r=-1,e=null==t?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}pr.prototype.clear=function(){this.size=0,this.__data__={hash:new cr,map:new(lr||fr),string:new cr}},pr.prototype.delete=function(t){var r=hr(this,t).delete(t);return this.size-=r?1:0,r},pr.prototype.get=function(t){return hr(this,t).get(t)},pr.prototype.has=function(t){return hr(this,t).has(t)},pr.prototype.set=function(t,r){var e=hr(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this};var vr="Expected a function";function yr(t,r){if("function"!=typeof t||null!=r&&"function"!=typeof r)throw new TypeError(vr);var e=function(){var n=arguments,o=r?r.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return e.cache=i.set(o,u)||i,u};return e.cache=new(yr.Cache||pr),e}yr.Cache=pr;var dr=500;var br=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_r=/\\(\\)?/g,gr=function(t){var r=yr(t,(function(t){return e.size===dr&&e.clear(),t})),e=r.cache;return r}((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(br,(function(t,e,n,o){r.push(n?o.replace(_r,"$1"):e||t)})),r}));function jr(t,r){return E(t)?t:rr(t,r)?[t]:gr(function(t){return null==t?"":k(t)}(t))}var wr=1/0;function xr(t){if("string"==typeof t||z(t))return t;var r=t+"";return"0"==r&&1/t==-wr?"-0":r}function mr(t,r){for(var e=0,n=(r=jr(r,t)).length;null!=t&&e<n;)t=t[xr(r[e++])];return e&&e==n?t:void 0}var Or=Rt(Object.getPrototypeOf,Object),Ar="[object Object]",Mr=Function.prototype,Sr=Object.prototype,Pr=Mr.toString,zr=Sr.hasOwnProperty,Er=Pr.call(Object);var Tr=200;function Fr(t){var r=this.__data__=new fr(t);this.size=r.size}Fr.prototype.clear=function(){this.__data__=new fr,this.size=0},Fr.prototype.delete=function(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e},Fr.prototype.get=function(t){return this.__data__.get(t)},Fr.prototype.has=function(t){return this.__data__.has(t)},Fr.prototype.set=function(t,r){var e=this.__data__;if(e instanceof fr){var n=e.__data__;if(!lr||n.length<Tr-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new pr(n)}return e.set(t,r),this.size=e.size,this};var Cr="object"==typeof t&&t&&!t.nodeType&&t,kr=Cr&&"object"==typeof module&&module&&!module.nodeType&&module,Dr=kr&&kr.exports===Cr?d.Buffer:void 0,Lr=Dr?Dr.allocUnsafe:void 0;var Nr=Object.prototype.propertyIsEnumerable,Gr=Object.getOwnPropertySymbols,Ir=Gr?function(t){return null==t?[]:(t=Object(t),function(t,r){for(var e=-1,n=null==t?0:t.length,o=0,i=[];++e<n;){var u=t[e];r(u,e,t)&&(i[o++]=u)}return i}(Gr(t),(function(r){return Nr.call(t,r)})))}:function(){return[]};function Xr(t){return function(t,r,e){var n=r(t);return E(t)?n:function(t,r){for(var e=-1,n=r.length,o=t.length;++e<n;)t[o+e]=r[e];return t}(n,e(t))}(t,Ht,Ir)}var Yr=tt(d,"DataView"),Ur=tt(d,"Promise"),$r=tt(d,"Set"),Br=R(Yr),qr=R(lr),Rr=R(Ur),Wr=R($r),Vr=R(rt),Hr=M;(Yr&&"[object DataView]"!=Hr(new Yr(new ArrayBuffer(1)))||lr&&"[object Map]"!=Hr(new lr)||Ur&&"[object Promise]"!=Hr(Ur.resolve())||$r&&"[object Set]"!=Hr(new $r)||rt&&"[object WeakMap]"!=Hr(new rt))&&(Hr=function(t){var r=M(t),e="[object Object]"==r?t.constructor:void 0,n=e?R(e):"";if(n)switch(n){case Br:return"[object DataView]";case qr:return"[object Map]";case Rr:return"[object Promise]";case Wr:return"[object Set]";case Vr:return"[object WeakMap]"}return r});var Jr=Hr,Kr=d.Uint8Array;function Qr(t,r){var e=r?function(t){var r=new t.constructor(t.byteLength);return new Kr(r).set(new Kr(t)),r}(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var Zr="__lodash_hash_undefined__";function te(t){var r=-1,e=null==t?0:t.length;for(this.__data__=new pr;++r<e;)this.add(t[r])}function re(t,r){for(var e=-1,n=null==t?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}te.prototype.add=te.prototype.push=function(t){return this.__data__.set(t,Zr),this},te.prototype.has=function(t){return this.__data__.has(t)};var ee=1,ne=2;function oe(t,r,e,n,o,i){var u=e&ee,c=t.length,a=r.length;if(c!=a&&!(u&&a>c))return!1;var s=i.get(t);if(s&&i.get(r))return s==r;var f=-1,l=!0,h=e&ne?new te:void 0;for(i.set(t,r),i.set(r,t);++f<c;){var p=t[f],v=r[f];if(n)var y=u?n(v,p,f,r,t,i):n(p,v,f,t,r,i);if(void 0!==y){if(y)continue;l=!1;break}if(h){if(!re(r,(function(t,r){if(u=r,!h.has(u)&&(p===t||o(p,t,e,n,i)))return h.push(r);var u}))){l=!1;break}}else if(p!==v&&!o(p,v,e,n,i)){l=!1;break}}return i.delete(t),i.delete(r),l}function ie(t){var r=-1,e=Array(t.size);return t.forEach((function(t,n){e[++r]=[n,t]})),e}function ue(t){var r=-1,e=Array(t.size);return t.forEach((function(t){e[++r]=t})),e}var ce=1,ae=2,se="[object Boolean]",fe="[object Date]",le="[object Error]",he="[object Map]",pe="[object Number]",ve="[object RegExp]",ye="[object Set]",de="[object String]",be="[object Symbol]",_e="[object ArrayBuffer]",ge="[object DataView]",je=b?b.prototype:void 0,we=je?je.valueOf:void 0;var xe=1,me=Object.prototype.hasOwnProperty;var Oe=1,Ae="[object Arguments]",Me="[object Array]",Se="[object Object]",Pe=Object.prototype.hasOwnProperty;function ze(t,r,e,n,o,i){var u=E(t),c=E(r),a=u?Me:Jr(t),s=c?Me:Jr(r),f=(a=a==Ae?Se:a)==Se,l=(s=s==Ae?Se:s)==Se,h=a==s;if(h&&Lt(t)){if(!Lt(r))return!1;u=!0,f=!1}if(h&&!f)return i||(i=new Fr),u||$t(t)?oe(t,r,e,n,o,i):function(t,r,e,n,o,i,u){switch(e){case ge:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case _e:return!(t.byteLength!=r.byteLength||!i(new Kr(t),new Kr(r)));case se:case fe:case pe:return bt(+t,+r);case le:return t.name==r.name&&t.message==r.message;case ve:case de:return t==r+"";case he:var c=ie;case ye:var a=n&ce;if(c||(c=ue),t.size!=r.size&&!a)return!1;var s=u.get(t);if(s)return s==r;n|=ae,u.set(t,r);var f=oe(c(t),c(r),n,o,i,u);return u.delete(t),f;case be:if(we)return we.call(t)==we.call(r)}return!1}(t,r,a,e,n,o,i);if(!(e&Oe)){var p=f&&Pe.call(t,"__wrapped__"),v=l&&Pe.call(r,"__wrapped__");if(p||v){var y=p?t.value():t,d=v?r.value():r;return i||(i=new Fr),o(y,d,e,n,i)}}return!!h&&(i||(i=new Fr),function(t,r,e,n,o,i){var u=e&xe,c=Xr(t),a=c.length;if(a!=Xr(r).length&&!u)return!1;for(var s=a;s--;){var f=c[s];if(!(u?f in r:me.call(r,f)))return!1}var l=i.get(t);if(l&&i.get(r))return l==r;var h=!0;i.set(t,r),i.set(r,t);for(var p=u;++s<a;){var v=t[f=c[s]],y=r[f];if(n)var d=u?n(y,v,f,r,t,i):n(v,y,f,t,r,i);if(!(void 0===d?v===y||o(v,y,e,n,i):d)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var b=t.constructor,_=r.constructor;b!=_&&"constructor"in t&&"constructor"in r&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(h=!1)}return i.delete(t),i.delete(r),h}(t,r,e,n,o,i))}function Ee(t,r,e,n,o){return t===r||(null==t||null==r||!S(t)&&!S(r)?t!=t&&r!=r:ze(t,r,e,n,Ee,o))}var Te=1,Fe=2;function Ce(t){return t==t&&!D(t)}function ke(t,r){return function(e){return null!=e&&(e[t]===r&&(void 0!==r||t in Object(e)))}}function De(t){var r=function(t){for(var r=Ht(t),e=r.length;e--;){var n=r[e],o=t[n];r[e]=[n,o,Ce(o)]}return r}(t);return 1==r.length&&r[0][2]?ke(r[0][0],r[0][1]):function(e){return e===t||function(t,r,e,n){var o=e.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=e[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var a=(c=e[o])[0],s=t[a],f=c[1];if(u&&c[2]){if(void 0===s&&!(a in t))return!1}else{var l=new Fr;if(n)var h=n(s,f,a,t,r,l);if(!(void 0===h?Ee(f,s,Te|Fe,n,l):h))return!1}}return!0}(e,t,r)}}function Le(t,r){return null!=t&&r in Object(t)}function Ne(t,r){return null!=t&&function(t,r,e){for(var n=-1,o=(r=jr(r,t)).length,i=!1;++n<o;){var u=xr(r[n]);if(!(i=null!=t&&e(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&mt(o)&&yt(u,o)&&(E(t)||Ft(t))}(t,r,Le)}var Ge=1,Ie=2;function Xe(t,r){return rr(t)&&Ce(r)?ke(xr(t),r):function(e){var n=function(t,r,e){var n=null==t?void 0:mr(t,r);return void 0===n?e:n}(e,t);return void 0===n&&n===r?Ne(e,t):Ee(r,n,Ge|Ie)}}function Ye(t){return rr(t)?(r=xr(t),function(t){return null==t?void 0:t[r]}):function(t){return function(r){return mr(r,t)}}(t);var r}var Ue,$e=function(t,r,e){for(var n=-1,o=Object(t),i=e(t),u=i.length;u--;){var c=i[Ue?u:++n];if(!1===r(o[c],c,o))break}return t};function Be(t,r,e){(void 0===e||bt(t[r],e))&&(void 0!==e||r in t)||dt(t,r,e)}function qe(t,r){if(("constructor"!==r||"function"!=typeof t[r])&&"__proto__"!=r)return t[r]}function Re(t){return function(t,r,e,n){var o=!e;e||(e={});for(var i=-1,u=r.length;++i<u;){var c=r[i],a=n?n(e[c],t[c],c,e,t):void 0;void 0===a&&(a=t[c]),o?dt(e,c,a):gt(e,c,a)}return e}(t,Qt(t))}function We(t,r,e,n,o,i,u){var c=qe(t,e),a=qe(r,e),s=u.get(a);if(s)Be(t,e,s);else{var f,l=i?i(c,a,e+"",t,r,u):void 0,h=void 0===l;if(h){var p=E(a),v=!p&&Lt(a),y=!p&&!v&&$t(a);l=a,p||v||y?E(c)?l=c:S(f=c)&&Ot(f)?l=function(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}(c):v?(h=!1,l=function(t,r){if(r)return t.slice();var e=t.length,n=Lr?Lr(e):new t.constructor(e);return t.copy(n),n}(a,!0)):y?(h=!1,l=Qr(a,!0)):l=[]:function(t){if(!S(t)||M(t)!=Ar)return!1;var r=Or(t);if(null===r)return!0;var e=zr.call(r,"constructor")&&r.constructor;return"function"==typeof e&&e instanceof e&&Pr.call(e)==Er}(a)||Ft(a)?(l=c,Ft(c)?l=Re(c):D(c)&&!Y(c)||(l=function(t){return"function"!=typeof t.constructor||Mt(t)?{}:nt(Or(t))}(a))):h=!1}h&&(u.set(a,l),o(l,a,n,i,u),u.delete(a)),Be(t,e,l)}}function Ve(t,r,e,n,o){t!==r&&$e(r,(function(i,u){if(o||(o=new Fr),D(i))We(t,r,u,e,Ve,n,o);else{var c=n?n(qe(t,u),i,u+"",t,r,o):void 0;void 0===c&&(c=i),Be(t,u,c)}}),Qt)}var He,Je=(He=function(t,r,e){Ve(t,r,e)},wt((function(t,r){var e=-1,n=r.length,o=n>1?r[n-1]:void 0,i=n>2?r[2]:void 0;for(o=He.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,r,e){if(!D(e))return!1;var n=typeof r;return!!("number"==n?Ot(e)&&yt(r,e.length):"string"==n&&r in e)&&bt(e[r],t)}(r[0],r[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++e<n;){var u=r[e];u&&He(t,u,e,o)}return t})));var Ke=4294967294,Qe=Math.floor,Ze=Math.min;function tn(t,r,e){return function(t,r,e,n){r=e(r);for(var o=0,i=null==t?0:t.length,u=r!=r,c=null===r,a=z(r),s=void 0===r;o<i;){var f=Qe((o+i)/2),l=e(t[f]),h=void 0!==l,p=null===l,v=l==l,y=z(l);if(u)var d=n||v;else d=s?v&&(n||h):c?v&&h&&(n||!p):a?v&&h&&!p&&(n||!y):!p&&!y&&(n?l<=r:l<r);d?o=f+1:i=f}return Ze(i,Ke)}(t,r,function(t){return"function"==typeof t?t:null==t?L:"object"==typeof t?E(t)?Xe(t[0],t[1]):De(t):Ye(t)}(e))}class rn{constructor(t,r){this.x=t,this.y=r}snapToGrid(t,r){return this.x=en(this.x,t),this.y=en(this.y,r||t),this}clone(){return new rn(this.x,this.y)}toString(){return this.x+"@"+this.y}equals(t){return!!t&&this.x===t.x&&this.y===t.y}difference(t,r){return new rn(this.x-(t||0),this.y-(r||0))}theta(t){const r=-(t.y-this.y),e=t.x-this.x;let n=Math.atan2(r,e);return n<0&&(n=2*Math.PI+n),180*n/Math.PI}offset(t,r){return this.x+=t||0,this.y+=r||0,this}}function en(t,r){return r*Math.round(t/r)}class nn{constructor(t,r,e,n){this.x=t,this.y=r,this.width=e,this.height=n}origin(){return new rn(this.x,this.y)}corner(){return new rn(this.x+this.width,this.y+this.height)}moveAndExpand(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}containsPoint(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height}}function on({x:t,y:r}){return new rn(t,r)}function un(t){return t.toString()}function cn(t,r){let e=1/0;for(let n=0,o=r.length;n<o;n++){const o=an(t,r[n]);o<e&&(e=o)}return e}function an(t,r){return Math.abs(t.x-r.x)+Math.abs(t.y-r.y)}function sn(t){return new rn(0===t.x?0:Math.abs(t.x)/t.x,0===t.y?0:Math.abs(t.y)/t.y)}function fn(t,r,e,n,o){const i=360/e,u=ln(t.theta(function(t,r,e,n){const o=r.x-t.x,i=r.y-t.y,u=o/e.x,c=i/e.y,a=u*n,s=c*n;return new rn(t.x+a,t.y+s)}(t,r,n,o))+i/2);return i*Math.floor(u/i)}function ln(t){return t%360+(t<0?360:0)}function hn(t,r){const e=Math.abs(t-r);return e>180?360-e:e}function pn(t,r,e){return function(t,r){const e=Math.pow(10,r||0);return t.x=Math.round(t.x*e)/e,t.y=Math.round(t.y*e)/e,t}(function(t,r){const e=r.source,n=vn(t.x-e.x,r.x)+e.x,o=vn(t.y-e.y,r.y)+e.y;return new rn(n,o)}(t.clone(),r),e)}function vn(t,r){return r*Math.round(t/r)}function yn(t,r){const e=function(t){return Math.ceil(Math.sqrt(t*t<<1))}(t),n=[{offsetX:t,offsetY:0,cost:t},{offsetX:t,offsetY:t,cost:e},{offsetX:0,offsetY:t,cost:t},{offsetX:-t,offsetY:t,cost:e},{offsetX:-t,offsetY:0,cost:t},{offsetX:-t,offsetY:-t,cost:e},{offsetX:0,offsetY:-t,cost:t},{offsetX:t,offsetY:-t,cost:e}];return n.forEach(t=>{var r=new rn(0,0),e=new rn(t.offsetX,t.offsetY);t.angle=ln(r.theta(e))}),4===r?[n[0],n[2],n[4],n[6]]:n}function dn(t,r,e,n){return pn(new rn(t.x+r.x*e[0],t.y+r.y*e[1]),r,n)}function bn(t,r,e){return new rn(t.x+r*e[0],t.y+r*e[1])}function _n(t,r){if(!t)return r;const e=Math.abs(t),n=Math.round(e/r);return n?r+(e-n*r)/n:e}class gn{constructor(){this.map={},this.mapGridSize=100}build(t,r){return t.reduce((t,e)=>{const n=function(t){const{x:r,y:e,width:n,height:o}=t;return new nn(r,e,n,o)}(e).moveAndExpand(function(t){return{width:2*t,height:2*t,x:-t,y:-t}}(r)),o=n.origin().snapToGrid(this.mapGridSize),i=n.corner().snapToGrid(this.mapGridSize);for(let r=o.x;r<=i.x;r+=this.mapGridSize)for(let e=o.y;e<=i.y;e+=this.mapGridSize){const o=r+"@"+e;t[o]=t[o]||[],t[o].push(n)}return t},this.map),this}isPointAccessible(t){const r=t.clone().snapToGrid(this.mapGridSize).toString();return!this.map[r]||this.map[r].every(r=>!r.containsPoint(t))}}class jn{constructor(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}add(t,r){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=r;const e=tn(this.items,t,t=>this.values[t]);this.items.splice(e,0,t)}remove(t){this.hash[t]=this.CLOSE}isOpen(t){return this.hash[t]===this.OPEN}isClose(t){return this.hash[t]===this.CLOSE}isEmpty(){return 0===this.items.length}pop(){const t=this.items.shift();return this.remove(t),t}}const wn={step:10,maxAllowedDirectionChange:90,precision:1,maximumLoops:2e3,directions(){return yn(this.step,4)}};function xn(t,r,o,i){if(!e(t,r)||!l(t.direction)||!function(t){return Array.isArray(t)&&t.every(n)}(o))throw new TypeError("invalid parameter!");(i=Je({},wn,i)).directions=function(t,r,e){var n=-1,o=(r=jr(r,t)).length;for(o||(o=1,t=void 0);++n<o;){var i=null==t?void 0:t[xr(r[n])];void 0===i&&(n=o,i=e),t=Y(i)?i.call(t):i}return t}(i,"directions");const{step:u,maxAllowedDirectionChange:c,precision:a,maximumLoops:s,directions:h}=i,p=on(t),v=on(r),y=(new gn).build(o,u),d=function(t,r,e){return{source:Object.assign({},r),x:_n(e.x-r.x,t),y:_n(e.y-r.y,t)}}(u,t,r),b=bn(p,u,f(t.direction)),_=bn(v,u,f(r.direction)),g=[dn(b,d,f(t.direction),a)],j=[dn(_,d,f(r.direction),a)],w=new jn,x={},m={},O={};w.add(un(b),an(b,_)),x[un(b)]=b,O[un(b)]=0;const A=un(j[0]);let M,S;const P=function(t){return{0:0,45:t/2,90:t/2}}(u);!function(t,r,e){t.forEach(t=>{t.gridOffsetX=t.offsetX/e*r.x,t.gridOffsetY=t.offsetY/e*r.y})}(h,d,u);const z=h.length;let E=s;for(;!w.isEmpty()&&E>0;){const t=w.pop(),r=x[t],e=m[t],n=O[t],o=void 0===e,i=r.equals(b);let s;s=o?i?null:fn(b,r,z,d,u):fn(e,r,z,d,u);const f=Ee(g,j);if(!(o&&f)&&A===t)return mn(m,x,r,b,_,p,v);for(let t=0;t<z;t++){if(S=hn(s,(M=h[t]).angle),!i&&S>c)continue;const e=pn(r.clone().offset(M.gridOffsetX,M.gridOffsetY),d,a),o=un(e);if(w.isClose(o)||!y.isPointAccessible(e))continue;const u=n+M.cost+(i?0:P[S]);(!w.isOpen(o)||u<O[o])&&(x[o]=e,m[o]=r,O[o]=u,w.add(o,u+cn(e,j))),E--}}}function mn(t,r,e,n,o,i,u){const c=[];let a,s=sn(o.difference(e.x,e.y)),f=un(e),l=t[f];for(;l;){const e=sn((a=r[f]).difference(l.x,l.y));e.equals(s)||(c.unshift(a),s=e),l=t[f=un(l)]}const h=r[f];return sn(h.difference(n.x,n.y)).equals(s)||c.unshift(h),c.unshift(i),c.push(u),c}const On={directions(){return yn(this.step,8)}};return t.manhattan=xn,t.metro=function(t,r,e,n){return xn(t,r,e,Je({},On,n))},t.orthogonal=function(t,r,{extensionCord:n=10,turnRatio:a=.5}){if(!e(t,r)||!l(t.direction))throw new TypeError("invalid parameter!");let v=c(f(t.direction)),y=r.direction;if(!y||y===s.MID){const e=(d=r,{x:(b=t).x-d.x,y:b.y-d.y});y=Math.abs(e.x)>Math.abs(e.y)?e.x>0?s.RIGHT:s.LEFT:e.y>0?s.DOWN:s.UP}var d,b;y=c(f(y));const _=o(t,i(v,n)),g=o(r,i(y,n));y=i(y,-1);const j=[{x:g.x-_.x,y:0},{x:0,y:g.y-_.y}],w=p(j,v),x=p(j,y),m=u(w,x)>0?2:1,O=h(j,x),A=[];if(A.push(t,_),1===m){const t=o(_,w),r=o(t,x);A.push(t,r)}else{const t=o(_,i(w,a)),r=o(t,O),e=o(r,i(x,1-a));A.push(t,r,e)}return A.push(r),A},t}({});
